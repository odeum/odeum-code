
@{%

const lexer = moo({
  '(': '(',
  ')': ')',
  ',': ',',
  'word': /[a-z]+/,
  'ws': {match: /\s+/, lineBreaks: true},
})
lexer.has = function(name) { return lexer.groups.find(function(group) { return group.tokenType === name; }); }

%}
@lexer lexer

main -> _ tuple _

tuple -> "(" _ p1 _ ")"

p1 -> p2 _ "," _ p1
    | p2

p2 -> p1 __ p2
    | tuple
    | atom

_ -> %ws:?
__ -> %ws

